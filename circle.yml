---
machine:
  environment:
    BEET_BASE: "/home/ubuntu/workspace"
    ROLE_NAME: "beetboxvm.drupal"
dependencies:
  override:
    - bash -e <(curl -fsSL http://bit.ly/beetbuild)
    - sudo rm -rf /beetbox/provisioning/ansible/roles/$ROLE_NAME
    - sudo ln -s ~/$CIRCLE_PROJECT_REPONAME $ROLE_PATH
test:
  override:
    - sudo mkdir -p $BEET_BASE/.beetbox
    - sudo cp ~/$CIRCLE_PROJECT_REPONAME/.beetbox/config.yml $BEET_BASE/.beetbox/config.yml
    - bash -e <(curl -fsSL http://bit.ly/beetbuild)
    - sudo rm -rf $BEET_BASE && sudo mkdir -p $BEET_BASE/.beetbox
    - sudo cp -f ~/$CIRCLE_PROJECT_REPONAME/.beetbox/composer.yml $BEET_BASE/.beetbox/config.yml
    - bash -e <(curl -fsSL http://bit.ly/beetbuild)
